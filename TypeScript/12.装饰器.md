# 装饰器

1 装饰器定义：装饰器就是一个方法或者叫函数，可以注入【写到】到类、方法、属性、参数，对象上，扩展其功能。

课外了解：高阶组件本质上也采用了装饰器的思想。

2 装饰器要解决的问题：

装饰器就就是解决在不修改原来类、方法，属性，参数的时候为其添加额外的功能。比如：为整个项目的所有业务类【假如 50 个类】的所有方法【假如 6 个方法】都增加日志信息，如果一个一个的增加，那要增加
300 次日志调用语句，假如日后日志文件格式发生了改变，也还需要修改 300 次。如果有了装饰器，只需要
修改一次就可以。这个属于项目中的通用功能，大家了解下即可，后面我们仿 Nestjs 实战时对装饰器的这
个特性会有很深的体会。

在 Nestjs 中装饰器可以解决依赖注入的问题，而依赖注入是 Java 等后端语言拥有的非常优秀的编程思想，有了依赖注入，能大大降低项目的耦合度，大大提升项目的可扩展性。

使用和创建分离是依赖注入的核心思想。

3.装饰器分类：

常见的装饰器：类装饰器、属性装饰器、方法装饰器、参数装饰器，元数据装饰器。

4.元数据装饰器初步理解：

元数据装饰器：在定义类或者类方法的时候，可以设置一些元数据，我们可以获取到在类与类方法上添加的元数据，需要引入 reflect-metadata 第三方库采用@Reflect.metadata 来实现。元数据指的是描述东西时用的数据，例如：Reflect.metadata("importinfo”，"疫情期间用公筷，戴口罩”)。

5.装饰器两种写法：

写法 1：让调用时（使用时）不传递参数的装饰器

写法 2：装饰器工厂【让调用时可以传递参数的装饰器】。

10-3【类装饰器】类装饰器实现

课程安排：1.环境搭建 2.类装饰器两种实现

1.环境撘建

1.安装 concurrently 支持合并执行，同时运行多个 script 命令：

> cnpm i concurrently -S 或 yarn add concurrently --save
> 2.tsconfig.json 文件修改如下：

```json
—-编译输入输出目录
"outDir":"./dist",
"rootDir":"./src",
--消除装饰器警告
"experimentalDecorators": true,
"emitDecoratorMetadata": true,
```

3.配置 package.json 文件脚本信息

```json

"scripts":{
"dev:build":"tsc -w",
--监控 dist/teaching目录中的js文件，变化时执行 node命令
"dev:start":"nodemon --watch dist/teaching js --exec node ./dist/teaching/1classDecorator.js",
--合并启动
"start":"concurrently npm:dev:*",
--命令解决 typescript 编译装饰器类时出现的bug
"tsc":"tsc src/teaching/1ClassDecorator.ts --target ES5 -w --experimentalDecorators",
--本章后面章节会用到，先配置上
"ctrl":"ts-node src/controller/HomeController.ts",
"beginapp": "nodemon --watch src/ -e ts --exec ts-node ./src/expressapp.ts",
}
```
