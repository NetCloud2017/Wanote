# JavaScript 执行机制

一段 js 代码在执行之之前会被 js 解析引擎编译， 编译后的代码会被分词两部分： 执行上下文 和 可执行代码；
<img src="./img/5sxw.png" />

执行上下文是 JavaScript 执行一段代码时的运行环境，比如调用一个函数，就会进入这个函数的执行上下文，确定该函数在执行期间用到的诸如 this、变量、对象以及函数等。在执行上下文中存在一个变量环境的对象（Viriable Environment），该对象中保存了变量提升的内容，比如上面代码中的声明的变量 myname 和函数声明 showName，都保存在该对象中。

变量环境对象会为声明变量创建一个 myname 属性， 并使用 undefined 对其初始化。函数声明则是放在堆内存中， 并在变量环境对象中 创建一个 showName 属性， 属性的值指向堆内存函数的地址。 其结构类似如下：

```js
VariableEnvironment:
     myname -> undefined,
     showName ->function : {console.log(myname)

```

接着 JavaScript 引擎会把声明以外的代码编译为字节码, 就是就是图中的可执行代码。

接着 JavaScript 引擎开始执行“可执行代码”，会按照顺序一行行地执行先执行的是 showName 函数，在变量环境中找到 showName 执行，下一行是打印 myname, 由于 变量环境中的值是 undefined，所以打印的是 undefined。 最后就是第三行对 myname 变量进行赋值， 赋值之后变量环境中的值就是 “极客时间”。

以上就是 JavaScript 的执行机制了，这也是 JavaScript 声明提前的原因。

**注意：**
在行首获取同名变量或函数时， 则函数被优先获取。在后面获取同名变量或函数时， 则以变量为优先获取；

```js
console.log(a.toString());
/**
 * function a() {
 *     console.log(22);
 * }
 *
 */
var a = 12;
function a() {
	console.log("12");
}
console.log(a); // 12
function a() {
	console.log(22);
}
console.log(typeof a, a); // number 12
```
